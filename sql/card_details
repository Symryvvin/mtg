DROP TRIGGER IF EXISTS `before_insert_lang_code`;
DROP TABLE IF EXISTS `card_metainfo`;
CREATE TABLE `card_metainfo` (
    `multiverse_ID` INT NOT NULL,
    `name` VARCHAR(200) NOT NULL,
    `lang_code` VARCHAR(2) NOT NULL,
    PRIMARY KEY (`multiverse_ID`),
    UNIQUE INDEX `multiverse_id_unique` (`multiverse_id`),
    INDEX `name` (`name`),
    FOREIGN KEY (`lang_code`) REFERENCES lang (`code`)
);
CREATE TRIGGER `before_insert_lang_code`
    BEFORE INSERT ON `card_metainfo` FOR EACH ROW
    BEGIN
        IF NEW.lang_code not in (SELECT code FROM lang)
        THEN
            SIGNAL SQLSTATE '45000'
                SET MESSAGE_TEXT = 'Cannot insert row with incorrect language code';
        END IF;
    END;
